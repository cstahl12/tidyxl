<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Tidyxl • tidyxl</title>
<!-- jquery --><script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script><!-- Font Awesome icons --><link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">
<!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../jquery.sticky-kit.min.js"></script><script src="../pkgdown.js"></script><!-- mathjax --><script src="https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--><!-- Google analytics --><script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-45097885-4', 'auto');
  ga('send', 'pageview');

</script>
</head>
<body>
    <div class="container template-vignette">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="../index.html">tidyxl</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="..//index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/tidyxl.html">Get Started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../news/index.html">News</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/nacnudus/tidyxl">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      
      </header><div class="row">
  <div class="col-md-9">
    <div class="page-header toc-ignore">
      <h1>Tidyxl</h1>
                        <h4 class="author">Duncan Garmonsway</h4>
            
            <h4 class="date">2017-09-18</h4>
          </div>

    
    
<div class="contents">
<style>
pre code, pre, code {
  white-space: pre !important;
  overflow-x: scroll !important;
  word-break: keep-all !important;
  word-wrap: initial !important;
}
</style>
<div id="tidyxl" class="section level1">
<h1 class="hasAnchor">
<a href="#tidyxl" class="anchor"></a>tidyxl</h1>
<p><a href="https://github.com/nacnudus/tidyxl">tidyxl</a> imports non-tabular data from Excel files into R. It exposes cell content, position, formatting and comments in a tidy structure for further manipulation, especially by the <a href="https://github.com/nacnudus/unpivotr">unpivotr</a> package. It supports the xml-based file formats ‘.xlsx’ and ‘.xlsm’ via the embedded <a href="http://rapidxml.sourceforge.net">RapidXML</a> C++ library. It does not support the binary file formats ‘.xlsb’ or ‘.xls’.</p>
<div id="installation" class="section level2">
<h2 class="hasAnchor">
<a href="#installation" class="anchor"></a>Installation</h2>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">devtools<span class="op">::</span><span class="kw"><a href="http://www.rdocumentation.org/packages/devtools/topics/install_github">install_github</a></span>(<span class="st">"nacnudus/tidyxl"</span>)</code></pre></div>
</div>
<div id="examples" class="section level2">
<h2 class="hasAnchor">
<a href="#examples" class="anchor"></a>Examples</h2>
<p>The package includes a spreadsheet, ‘titanic.xlsx’, which contains the following pivot table:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ftable</span>(Titanic, <span class="dt">row.vars =</span> <span class="dv">1</span><span class="op">:</span><span class="dv">2</span>)
<span class="co">#&gt;              Age      Child     Adult    </span>
<span class="co">#&gt;              Survived    No Yes    No Yes</span>
<span class="co">#&gt; Class Sex                                </span>
<span class="co">#&gt; 1st   Male                0   5   118  57</span>
<span class="co">#&gt;       Female              0   1     4 140</span>
<span class="co">#&gt; 2nd   Male                0  11   154  14</span>
<span class="co">#&gt;       Female              0  13    13  80</span>
<span class="co">#&gt; 3rd   Male               35  13   387  75</span>
<span class="co">#&gt;       Female             17  14    89  76</span>
<span class="co">#&gt; Crew  Male                0   0   670 192</span>
<span class="co">#&gt;       Female              0   0     3  20</span></code></pre></div>
<p>The multi-row column headers make this difficult to import. A popular package for importing spreadsheets coerces the pivot table into a dataframe. It treats the second header row as though it were observations.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">titanic &lt;-<span class="st"> </span><span class="kw">system.file</span>(<span class="st">"extdata/titanic.xlsx"</span>, <span class="dt">package =</span> <span class="st">"tidyxl"</span>)
readxl<span class="op">::</span><span class="kw"><a href="http://www.rdocumentation.org/packages/readxl/topics/read_excel">read_excel</a></span>(titanic)
<span class="co">#&gt; # A tibble: 10 x 7</span>
<span class="co">#&gt;     X__1   X__2      Age Child  X__3 Adult  X__4</span>
<span class="co">#&gt;    &lt;chr&gt;  &lt;chr&gt;    &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt;</span>
<span class="co">#&gt;  1  &lt;NA&gt;   &lt;NA&gt; Survived    No   Yes    No   Yes</span>
<span class="co">#&gt;  2 Class    Sex     &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt;</span>
<span class="co">#&gt;  3   1st   Male     &lt;NA&gt;     0     5   118    57</span>
<span class="co">#&gt;  4  &lt;NA&gt; Female     &lt;NA&gt;     0     1     4   140</span>
<span class="co">#&gt;  5   2nd   Male     &lt;NA&gt;     0    11   154    14</span>
<span class="co">#&gt;  6  &lt;NA&gt; Female     &lt;NA&gt;     0    13    13    80</span>
<span class="co">#&gt;  7   3rd   Male     &lt;NA&gt;    35    13   387    75</span>
<span class="co">#&gt;  8  &lt;NA&gt; Female     &lt;NA&gt;    17    14    89    76</span>
<span class="co">#&gt;  9  Crew   Male     &lt;NA&gt;     0     0   670   192</span>
<span class="co">#&gt; 10  &lt;NA&gt; Female     &lt;NA&gt;     0     0     3    20</span></code></pre></div>
<p><a href="https://github.com/nacnudus/tidyxl">Tidyxl</a> doesn’t coerce the pivot table into a data frame. Instead, it represents each cell in its own row, where it describes the cell’s address, value and other properties.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(tidyxl)
x &lt;-<span class="st"> </span><span class="kw"><a href="../reference/tidy_xlsx.html">tidy_xlsx</a></span>(titanic)<span class="op">$</span>data<span class="op">$</span>Sheet1
<span class="co"># Specific sheets can be requested using `tidy_xlsx(file, sheet)`</span>
<span class="kw">str</span>(x)
<span class="co">#&gt; Classes 'tbl_df', 'tbl' and 'data.frame':    60 obs. of  20 variables:</span>
<span class="co">#&gt;  $ address        : chr  "C1" "D1" "E1" "F1" ...</span>
<span class="co">#&gt;  $ row            : int  1 1 1 1 1 2 2 2 2 2 ...</span>
<span class="co">#&gt;  $ col            : int  3 4 5 6 7 3 4 5 6 7 ...</span>
<span class="co">#&gt;  $ content        : chr  "0" "1" NA "2" ...</span>
<span class="co">#&gt;  $ formula        : chr  NA NA NA NA ...</span>
<span class="co">#&gt;  $ formula_type   : chr  NA NA NA NA ...</span>
<span class="co">#&gt;  $ formula_ref    : chr  NA NA NA NA ...</span>
<span class="co">#&gt;  $ formula_group  : int  NA NA NA NA NA NA NA NA NA NA ...</span>
<span class="co">#&gt;  $ type           : chr  "s" "s" NA "s" ...</span>
<span class="co">#&gt;  $ data_type      : chr  "character" "character" "blank" "character" ...</span>
<span class="co">#&gt;  $ error          : chr  NA NA NA NA ...</span>
<span class="co">#&gt;  $ logical        : logi  NA NA NA NA NA NA ...</span>
<span class="co">#&gt;  $ numeric        : num  NA NA NA NA NA NA NA NA NA NA ...</span>
<span class="co">#&gt;  $ date           : POSIXct, format: NA NA ...</span>
<span class="co">#&gt;  $ character      : chr  "Age" "Child" NA "Adult" ...</span>
<span class="co">#&gt;  $ comment        : chr  NA NA NA NA ...</span>
<span class="co">#&gt;  $ height         : num  15 15 15 15 15 15 15 15 15 15 ...</span>
<span class="co">#&gt;  $ width          : num  8.38 8.38 8.38 8.38 8.38 8.38 8.38 8.38 8.38 8.38 ...</span>
<span class="co">#&gt;  $ style_format   : chr  "Normal" "Normal" "Normal" "Normal" ...</span>
<span class="co">#&gt;  $ local_format_id: int  2 3 3 3 3 2 3 3 3 3 ...</span></code></pre></div>
<p>In this structure, the cells can be found by filtering.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">x[x<span class="op">$</span>data_type <span class="op">==</span><span class="st"> "character"</span>, <span class="kw">c</span>(<span class="st">"address"</span>, <span class="st">"character"</span>)]
<span class="co">#&gt; # A tibble: 22 x 2</span>
<span class="co">#&gt;    address character</span>
<span class="co">#&gt;      &lt;chr&gt;     &lt;chr&gt;</span>
<span class="co">#&gt;  1      C1       Age</span>
<span class="co">#&gt;  2      D1     Child</span>
<span class="co">#&gt;  3      F1     Adult</span>
<span class="co">#&gt;  4      C2  Survived</span>
<span class="co">#&gt;  5      D2        No</span>
<span class="co">#&gt;  6      E2       Yes</span>
<span class="co">#&gt;  7      F2        No</span>
<span class="co">#&gt;  8      G2       Yes</span>
<span class="co">#&gt;  9      A3     Class</span>
<span class="co">#&gt; 10      B3       Sex</span>
<span class="co">#&gt; # ... with 12 more rows</span>
x[x<span class="op">$</span>row <span class="op">==</span><span class="st"> </span><span class="dv">4</span>, <span class="kw">c</span>(<span class="st">"address"</span>, <span class="st">"character"</span>, <span class="st">"numeric"</span>)]
<span class="co">#&gt; # A tibble: 6 x 3</span>
<span class="co">#&gt;   address character numeric</span>
<span class="co">#&gt;     &lt;chr&gt;     &lt;chr&gt;   &lt;dbl&gt;</span>
<span class="co">#&gt; 1      A4       1st      NA</span>
<span class="co">#&gt; 2      B4      Male      NA</span>
<span class="co">#&gt; 3      D4      &lt;NA&gt;       0</span>
<span class="co">#&gt; 4      E4      &lt;NA&gt;       5</span>
<span class="co">#&gt; 5      F4      &lt;NA&gt;     118</span>
<span class="co">#&gt; 6      G4      &lt;NA&gt;      57</span></code></pre></div>
<div id="formatting" class="section level3">
<h3 class="hasAnchor">
<a href="#formatting" class="anchor"></a>Formatting</h3>
<p>The original spreadsheet has formatting applied to the cells. This can also be retrieved using <a href="https://github.com/nacnudus/tidyxl">tidyxl</a>.</p>
<div class="figure">
<img src="titanic-screenshot.png">
</div>
<p>Formatting is available by using the columns <code>local_format_id</code> and <code>style_format_id</code> as indexes into a separate list-of-lists structure. ‘Local’ formatting is the most common kind, applied to individual cells. ‘Style’ formatting is usually applied to blocks of cells, and defines several formats at once. Here is a screenshot of the styles buttons in Excel.</p>
<div class="figure">
<img src="styles-screenshot.png">
</div>
<p>Formatting can be looked up as follows.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Bold</span>
formats &lt;-<span class="st"> </span><span class="kw"><a href="../reference/tidy_xlsx.html">tidy_xlsx</a></span>(titanic)<span class="op">$</span>formats
formats<span class="op">$</span>local<span class="op">$</span>font<span class="op">$</span>bold
<span class="co">#&gt; [1] FALSE  TRUE FALSE FALSE</span>
x[x<span class="op">$</span>local_format_id <span class="op">%in%</span><span class="st"> </span><span class="kw">which</span>(formats<span class="op">$</span>local<span class="op">$</span>font<span class="op">$</span>bold),
  <span class="kw">c</span>(<span class="st">"address"</span>, <span class="st">"character"</span>)]
<span class="co">#&gt; # A tibble: 4 x 2</span>
<span class="co">#&gt;   address character</span>
<span class="co">#&gt;     &lt;chr&gt;     &lt;chr&gt;</span>
<span class="co">#&gt; 1      C1       Age</span>
<span class="co">#&gt; 2      C2  Survived</span>
<span class="co">#&gt; 3      A3     Class</span>
<span class="co">#&gt; 4      B3       Sex</span>

<span class="co"># Yellow fill</span>
formats<span class="op">$</span>local<span class="op">$</span>fill<span class="op">$</span>patternFill<span class="op">$</span>fgColor<span class="op">$</span>rgb
<span class="co">#&gt; [1] NA         NA         NA         "FFFFFF00"</span>
x[x<span class="op">$</span>local_format_id <span class="op">%in%</span>
<span class="st">  </span><span class="kw">which</span>(formats<span class="op">$</span>local<span class="op">$</span>fill<span class="op">$</span>patternFill<span class="op">$</span>fgColor<span class="op">$</span>rgb <span class="op">==</span><span class="st"> "FFFFFF00"</span>),
  <span class="kw">c</span>(<span class="st">"address"</span>, <span class="st">"numeric"</span>)]
<span class="co">#&gt; # A tibble: 2 x 2</span>
<span class="co">#&gt;   address numeric</span>
<span class="co">#&gt;     &lt;chr&gt;   &lt;dbl&gt;</span>
<span class="co">#&gt; 1     F11       3</span>
<span class="co">#&gt; 2     G11      20</span>

<span class="co"># Styles by name</span>
formats<span class="op">$</span>style<span class="op">$</span>font<span class="op">$</span>name[<span class="st">"Normal"</span>]
<span class="co">#&gt;    Normal </span>
<span class="co">#&gt; "Calibri"</span>
<span class="kw">head</span>(x[x<span class="op">$</span>style_format <span class="op">==</span><span class="st"> "Normal"</span>, <span class="kw">c</span>(<span class="st">"address"</span>, <span class="st">"character"</span>)])
<span class="co">#&gt; # A tibble: 6 x 2</span>
<span class="co">#&gt;   address character</span>
<span class="co">#&gt;     &lt;chr&gt;     &lt;chr&gt;</span>
<span class="co">#&gt; 1      C1       Age</span>
<span class="co">#&gt; 2      D1     Child</span>
<span class="co">#&gt; 3      E1      &lt;NA&gt;</span>
<span class="co">#&gt; 4      F1     Adult</span>
<span class="co">#&gt; 5      G1      &lt;NA&gt;</span>
<span class="co">#&gt; 6      C2  Survived</span></code></pre></div>
<p>To see all the available kinds of formats, use <code>str(formats)</code>.</p>
</div>
<div id="comments" class="section level3">
<h3 class="hasAnchor">
<a href="#comments" class="anchor"></a>Comments</h3>
<p>Comments are available alongside cell values.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">x[<span class="op">!</span><span class="kw">is.na</span>(x<span class="op">$</span>comment), <span class="kw">c</span>(<span class="st">"address"</span>, <span class="st">"comment"</span>)]
<span class="co">#&gt; # A tibble: 1 x 2</span>
<span class="co">#&gt;   address                                                     comment</span>
<span class="co">#&gt;     &lt;chr&gt;                                                       &lt;chr&gt;</span>
<span class="co">#&gt; 1     G11 All women in the crew worked in the victualling department.</span></code></pre></div>
</div>
<div id="formulas" class="section level3">
<h3 class="hasAnchor">
<a href="#formulas" class="anchor"></a>Formulas</h3>
<p>Formulas are available, but with a few quirks.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">options</span>(<span class="dt">width =</span> <span class="dv">120</span>)
y &lt;-<span class="st"> </span><span class="kw"><a href="../reference/tidy_xlsx.html">tidy_xlsx</a></span>(<span class="kw">system.file</span>(<span class="st">"/extdata/examples.xlsx"</span>, <span class="dt">package =</span> <span class="st">"tidyxl"</span>),
               <span class="st">"Sheet1"</span>)<span class="op">$</span>data[[<span class="dv">1</span>]]
y[<span class="op">!</span><span class="kw">is.na</span>(y<span class="op">$</span>formula),
  <span class="kw">c</span>(<span class="st">"address"</span>, <span class="st">"formula"</span>, <span class="st">"formula_type"</span>, <span class="st">"formula_ref"</span>, <span class="st">"formula_group"</span>,
    <span class="st">"error"</span>, <span class="st">"logical"</span>, <span class="st">"numeric"</span>, <span class="st">"date"</span>, <span class="st">"character"</span>)]
<span class="co">#&gt; # A tibble: 32 x 10</span>
<span class="co">#&gt;    address             formula formula_type formula_ref formula_group   error logical numeric       date     character</span>
<span class="co">#&gt;      &lt;chr&gt;               &lt;chr&gt;        &lt;chr&gt;       &lt;chr&gt;         &lt;int&gt;   &lt;chr&gt;   &lt;lgl&gt;   &lt;dbl&gt;     &lt;dttm&gt;         &lt;chr&gt;</span>
<span class="co">#&gt;  1      A1                 1/0         &lt;NA&gt;        &lt;NA&gt;            NA #DIV/0!      NA      NA         NA          &lt;NA&gt;</span>
<span class="co">#&gt;  2     A14                 1=1         &lt;NA&gt;        &lt;NA&gt;            NA    &lt;NA&gt;    TRUE      NA         NA          &lt;NA&gt;</span>
<span class="co">#&gt;  3     A15                A4+1         &lt;NA&gt;        &lt;NA&gt;            NA    &lt;NA&gt;      NA    1338         NA          &lt;NA&gt;</span>
<span class="co">#&gt;  4     A16     DATE(2017,1,18)         &lt;NA&gt;        &lt;NA&gt;            NA    &lt;NA&gt;      NA      NA 2017-01-18          &lt;NA&gt;</span>
<span class="co">#&gt;  5     A17 "\"Hello, World!\""         &lt;NA&gt;        &lt;NA&gt;            NA    &lt;NA&gt;      NA      NA         NA Hello, World!</span>
<span class="co">#&gt;  6     A19             $A$18+1         &lt;NA&gt;        &lt;NA&gt;            NA    &lt;NA&gt;      NA       2         NA          &lt;NA&gt;</span>
<span class="co">#&gt;  7     B19               A18+2         &lt;NA&gt;        &lt;NA&gt;            NA    &lt;NA&gt;      NA       3         NA          &lt;NA&gt;</span>
<span class="co">#&gt;  8     A20             $A$18+1       shared     A20:A21             0    &lt;NA&gt;      NA       2         NA          &lt;NA&gt;</span>
<span class="co">#&gt;  9     B20               A19+2       shared     B20:B21             1    &lt;NA&gt;      NA       4         NA          &lt;NA&gt;</span>
<span class="co">#&gt; 10     A21             $A$18+1       shared        &lt;NA&gt;             0    &lt;NA&gt;      NA       2         NA          &lt;NA&gt;</span>
<span class="co">#&gt; # ... with 22 more rows</span></code></pre></div>
<p>The top five cells show that the results of formulas are available as usual in the columns <code>error</code>, <code>logical</code>, <code>numeric</code>, <code>date</code>, and <code>character</code>.</p>
<p>Cells <code>A20</code> and <code>A21</code> share a formula definition. The formula is given against cell <code>A20</code>, and assigned to <code>formula_group</code> <code>0</code>, which spans the cells given by the <code>formula_ref</code>, A20:A21. A spreadsheet application would infer that cell <code>A21</code> had the formula <code>A20+1</code>. Cells <code>B20</code> and <code>B21</code> are similar. The roadmap for <a href="https://github.com/nacnudus/tidyxl">tidyxl</a> includes de-normalising shared formulas. If you can suggest how to tokenize Excel formulas, then please contact me.</p>
<p>Cell <code>A22</code> contains an array formula, which, in a spreadsheet application, would appear with curly braces <code>{SUM(A19:A21*B19:B21)}</code>. Cells <code>A23</code> and <code>A24</code> contain a single multi-cell array formula (single formula, multi-cell result), indicated by the <code>formula_ref</code>, but unlike cells <code>A20:A21</code> and <code>B20:B21</code>, the <code>formula</code> for A24 is NA rather than blank (<code>""</code>), and it doesn’t have a <code>formula_group</code>.</p>
<p>Cell <code>A25</code> contains a formula that refers to another file. The <code>[1]</code> is an index into a table of files. The roadmap <a href="https://github.com/nacnudus/tidyxl">tidyxl</a> for tidyxl includes de-referencing such numbers.</p>
<p><a href="https://github.com/nacnudus/tidyxl">tidyxl</a> imports the same table into a format suitable for non-tabular processing (see e.g. the <a href="https://github.com/nacnudus/unpivotr">unpivotr</a> package in ‘Similar projects’ below).</p>
</div>
</div>
<div id="philosophy" class="section level2">
<h2 class="hasAnchor">
<a href="#philosophy" class="anchor"></a>Philosophy</h2>
<p>Information in in many spreadsheets cannot be easily imported into R. Why?</p>
<p>Most R packages that import spreadsheets have difficulty unless the layout of the spreadsheet conforms to a strict definition of a ‘table’, e.g.:</p>
<ul>
<li>observations in rows</li>
<li>variables in columns</li>
<li>a single header row</li>
<li>all information represented by characters, whether textual, logical, or numeric</li>
</ul>
<p>These rules are designed to eliminate ambiguity in the interpretation of the information. But most spreadsheeting software relaxes these rules in a trade of ambiguity for expression via other media:</p>
<ul>
<li>proximity (other than headers, i.e. other than being the first value at the top of a column)</li>
<li>formatting (colours and borders)</li>
</ul>
<p>Humans can usually resolve the ambiguities with contextual knowledge, but computers are limited by their ignorance. Programmers are hampered by:</p>
<ul>
<li>their language’s expressiveness</li>
<li>loss of information in transfer from spreadsheet to programming library</li>
</ul>
<p>Information is lost when software discards it in order to force the data into tabular form. Sometimes date formatting is retained, but mostly formatting is lost, and position has to be inferred again.</p>
<p><a href="https://github.com/nacnudus/tidyxl">tidyxl</a> addresses the programmer’s problems by not discarding information. It imports the content, position and formatting of cells, leaving it up to the user to associate the different forms of information, and to re-encode them in tabular form without loss. The <a href="https://github.com/nacnudus/unpivotr">unpivotr</a> package has been developed to assist with that step.</p>
</div>
<div id="similar-projects" class="section level2">
<h2 class="hasAnchor">
<a href="#similar-projects" class="anchor"></a>Similar projects</h2>
<p><a href="https://github.com/nacnudus/tidyxl">tidyxl</a> was originally derived from <a href="https://github.com/hadley/readxl">readxl</a> and still contains some of the same code, hence it inherits the GPL-3 licence. <a href="https://github.com/hadley/readxl">readxl</a> is intended for importing tabular data with a single row of column headers, whereas <a href="https://github.com/nacnudus/tidyxl">tidyxl</a> is more general, and less magic.</p>
<p>The <a href="https://github.com/rsheets">rsheets</a> project of several R packages is in the early stages of importing spreadsheet information from Excel and Google Sheets into R, manipulating it, and potentially parsing and processing formulas and writing out to spreadsheet files. In particular, <a href="https://github.com/rsheets/jailbreakr">jailbreaker</a> attempts to extract non-tabular data from spreadsheets into tabular structures automatically via some clever algorithms.</p>
<p><a href="https://github.com/nacnudus/tidyxl">tidyxl</a> differs from <a href="https://github.com/rsheets">rsheets</a> in scope (<a href="https://github.com/nacnudus/tidyxl">tidyxl</a> will never import charts, for example), and implementation (<a href="https://github.com/nacnudus/tidyxl">tidyxl</a> is implemented mainly in C++ and is quite fast, only a little slower than <a href="https://github.com/hadley/readxl">readxl</a>). <a href="https://github.com/nacnudus/unpivotr">unpivotr</a> is a package related to <a href="https://github.com/nacnudus/tidyxl">tidyxl</a> that provides tools for unpivoting complex and non-tabular data layouts using I not AI (intelligence, not artificial intelligence). In this way it corresponds to <a href="https://github.com/rsheets/jailbreakr">jailbreaker</a>, but with a different philosophy.</p>
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li>
<a href="#tidyxl">tidyxl</a><ul class="nav nav-pills nav-stacked">
<li><a href="#installation">Installation</a></li>
      <li><a href="#examples">Examples</a></li>
      <li><a href="#philosophy">Philosophy</a></li>
      <li><a href="#similar-projects">Similar projects</a></li>
      </ul>
</li>
      </ul>
</div>
      </div>

</div>


      <footer><div class="copyright">
  <p>Developed by Duncan Garmonsway.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="http://hadley.github.io/pkgdown/">pkgdown</a>.</p>
</div>

      </footer>
</div>

  </body>
</html>
